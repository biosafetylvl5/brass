<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>brassy &#8212; brassy 0.0.1a documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=8c8a9e14"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />





  </head><body>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">


          <div class="body" role="main">

  <h1>Source code for brass</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module provides functionality to generate release notes from YAML files.</span>
<span class="sd">It reads YAML files, parses their content, and formats the parsed data into release notes in .rst format.</span>
<span class="sd">The release notes can be written to an output file.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">rich.progress</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">import</span> <span class="nn">pygit2</span>
<span class="kn">from</span> <span class="nn">rich.console</span> <span class="kn">import</span> <span class="n">Console</span>
<span class="kn">from</span> <span class="nn">rich_argparse</span> <span class="kn">import</span> <span class="n">RichHelpFormatter</span>

<span class="n">default_categories</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;bug-fix&quot;</span><span class="p">,</span>
    <span class="s2">&quot;feature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;enhancement&quot;</span><span class="p">,</span>
    <span class="s2">&quot;deprecation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;removal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;security&quot;</span><span class="p">,</span>
    <span class="s2">&quot;performance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;documentation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;maintenance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;other&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">default_title</span> <span class="o">=</span> <span class="s2">&quot;NO TITLE&quot;</span>
<span class="n">default_description</span> <span class="o">=</span> <span class="s2">&quot;NO DESCRIPTION&quot;</span>


<div class="viewcode-block" id="get_rich_opener">
<a class="viewcode-back" href="../api.html#brass.get_rich_opener">[docs]</a>
<span class="k">def</span> <span class="nf">get_rich_opener</span><span class="p">(</span><span class="n">no_format</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the appropriate opener function for rich progress bar.</span>

<span class="sd">    Args:</span>
<span class="sd">        no_format (bool, optional): If True, returns the opener function without any formatting.</span>
<span class="sd">            If False, returns the opener function with formatting. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        function: The opener function for rich progress bar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">no_format</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">rich</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">Progress</span><span class="p">()</span><span class="o">.</span><span class="n">open</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">rich</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">open</span></div>



<div class="viewcode-block" id="get_parser">
<a class="viewcode-back" href="../api.html#brass.get_parser">[docs]</a>
<span class="k">def</span> <span class="nf">get_parser</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an ArgumentParser object with predefined arguments for generating release notes from YAML files.</span>

<span class="sd">    Returns:</span>
<span class="sd">        argparse.ArgumentParser: The ArgumentParser object with predefined arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Generate release notes from YAML files.&quot;</span>
        <span class="o">+</span> <span class="s2">&quot; Entries are sorted by order in yaml files, &quot;</span>
        <span class="o">+</span> <span class="s2">&quot;and by order of yaml files provided via the command line.&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RichHelpFormatter</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-t&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--write-yaml-template&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Write template YAML to provided file.&quot;</span>
        <span class="o">+</span> <span class="s2">&quot; If folder provided, place template in folder with current &quot;</span>
        <span class="o">+</span> <span class="s2">&quot;git branch name as file name.&quot;</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;input_files_or_folders&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The folder(s) containing YAML files and/or YAML files. &quot;</span>
        <span class="o">+</span> <span class="s2">&quot;Folders will be searched recursively.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-v&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--version&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;[UNKNOWN]&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Version number of the release. Default is &#39;[UNKNOWN]&#39;.&quot;</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--release-date&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Date of the release. Default is current system time.&quot;</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-nc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--no-color&quot;</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Disable text formatting for CLI output.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-p&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--prefix-file&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;A header file to prepend to the release notes.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-s&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--suffix-file&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;A footer file to suffix to the release notes.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="s2">&quot;--output-file&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The output file for release notes.&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-nr&quot;</span><span class="p">,</span> <span class="s2">&quot;--no-rich&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Disable rich text output&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;--quiet&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Only output errors&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span></div>



<div class="viewcode-block" id="parse_arguments">
<a class="viewcode-back" href="../api.html#brass.parse_arguments">[docs]</a>
<span class="k">def</span> <span class="nf">parse_arguments</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse command line arguments for input folder and output file.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    argparse.Namespace</span>
<span class="sd">        Parsed arguments containing input_folder and output_file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">get_parser</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(),</span> <span class="n">parser</span></div>



<div class="viewcode-block" id="exit_on_invalid_arguments">
<a class="viewcode-back" href="../api.html#brass.exit_on_invalid_arguments">[docs]</a>
<span class="k">def</span> <span class="nf">exit_on_invalid_arguments</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">console</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate the argparse arguments.</span>

<span class="sd">    This function validates the provided argparse arguments to ensure</span>
<span class="sd">    that the required input files/folders and output file are provided.</span>
<span class="sd">    If arguments are invalid, it prints an error message and exits the program.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    args : argparse.Namespace</span>
<span class="sd">        Parsed arguments.</span>

<span class="sd">    parser : argparse.ArgumentParser</span>
<span class="sd">        The ArgumentParser object used to parse the command-line arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input_files_or_folders</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="s2">&quot;write_yaml_template&quot;</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">write_yaml_template</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;[bold red]Invalid arguments.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_yaml_template_path">
<a class="viewcode-back" href="../api.html#brass.get_yaml_template_path">[docs]</a>
<span class="k">def</span> <span class="nf">get_yaml_template_path</span><span class="p">(</span><span class="n">file_path_arg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the path of the YAML template file based on the given file path argument.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path_arg (str): The file path argument provided by the user.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path of the YAML template file.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">file_path_arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">get_current_git_branch</span><span class="p">()</span><span class="si">}</span><span class="s2">.yaml&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">file_path_arg</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yaml&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">file_path_arg</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yml&quot;</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">file_path_arg</span> <span class="o">+</span> <span class="s2">&quot;.yaml&quot;</span>
    <span class="k">return</span> <span class="n">file_path_arg</span></div>



<div class="viewcode-block" id="create_blank_template_yaml_file">
<a class="viewcode-back" href="../api.html#brass.create_blank_template_yaml_file">[docs]</a>
<span class="k">def</span> <span class="nf">create_blank_template_yaml_file</span><span class="p">(</span><span class="n">file_path_arg</span><span class="p">,</span> <span class="n">console</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a blank YAML file with default categories.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Path to the output YAML file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default_yaml</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">category</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}]</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">default_categories</span>
    <span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">yaml_template_path</span> <span class="o">=</span> <span class="n">get_yaml_template_path</span><span class="p">(</span><span class="n">file_path_arg</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">pygit2</span><span class="o">.</span><span class="n">GitError</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="s2">&quot;[bold red]Could not find a git repo. Please run in a &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;git repo or pass a file path for the yaml template &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;(eg &#39;-t /path/to/file.yaml&#39;).&quot;</span>
        <span class="p">)</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">yaml_template_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">default_yaml</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span></div>



<div class="viewcode-block" id="find_duplicate_titles">
<a class="viewcode-back" href="../api.html#brass.find_duplicate_titles">[docs]</a>
<span class="k">def</span> <span class="nf">find_duplicate_titles</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if there are any duplicate titles in dictionaries of lists of dictionaries.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict): A dictionary containing lists of dictionaries with items</span>
<span class="sd">         indexed by &quot;title&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if there are duplicate &quot;title&quot; values, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">category</span><span class="p">]]</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">titles</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span></div>



<div class="viewcode-block" id="exit_on_invalid_yaml">
<a class="viewcode-back" href="../api.html#brass.exit_on_invalid_yaml">[docs]</a>
<span class="k">def</span> <span class="nf">exit_on_invalid_yaml</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the YAML content follows the correct schema.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    content : dict</span>
<span class="sd">        Parsed content of the YAML file.</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Path to the YAML file.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the YAML content does not follow the correct schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">entries</span> <span class="ow">in</span> <span class="n">content</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid YAML content in file </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;Entries for category &#39;</span><span class="si">{category}</span><span class="s2">&#39; must be a list.&quot;</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid YAML content in file </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">. &quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;Entry in category &#39;</span><span class="si">{category}</span><span class="s2">&#39; must be a dictionary.&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">}:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid YAML content in file </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">. &quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;Entry in category &#39;</span><span class="si">{category}</span><span class="s2">&#39; must only have &quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;&#39;title&#39; and &#39;description&#39; keys.&quot;</span>
                <span class="p">)</span></div>



<div class="viewcode-block" id="read_yaml_files">
<a class="viewcode-back" href="../api.html#brass.read_yaml_files">[docs]</a>
<span class="k">def</span> <span class="nf">read_yaml_files</span><span class="p">(</span><span class="n">input_files</span><span class="p">,</span> <span class="n">rich_open</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read and parse the given list of YAML files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    input_files : list</span>
<span class="sd">        List of paths to the YAML files.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        Parsed content of all YAML files categorized by type of change.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; read_yaml_files([&quot;file1.yaml&quot;, &quot;file2.yaml&quot;])</span>
<span class="sd">    {&#39;bug-fix&#39;: [</span>
<span class="sd">        {&#39;title&#39;: &#39;fixed explosions&#39;,</span>
<span class="sd">          &#39;description&#39;: &#39;This fixed the explosion mechanism&#39;},</span>
<span class="sd">        {&#39;title&#39;: &#39;fixed cats not being cute&#39;,</span>
<span class="sd">          &#39;description&#39;: &#39;This made the cats WAY cuter&#39;}</span>
<span class="sd">        ]</span>
<span class="sd">    }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">input_files</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">rich_open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Reading </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="n">exit_on_invalid_yaml</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">entries</span> <span class="ow">in</span> <span class="n">content</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">entries</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">entry</span>
                    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="n">category</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>



<div class="viewcode-block" id="format_release_notes">
<a class="viewcode-back" href="../api.html#brass.format_release_notes">[docs]</a>
<span class="k">def</span> <span class="nf">format_release_notes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">release_date</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Format the parsed YAML data into release notes in .rst format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : dict</span>
<span class="sd">        Parsed content of YAML files.</span>
<span class="sd">    version : str, optional</span>
<span class="sd">        Version number of the release, by default &#39;1.1&#39;.</span>
<span class="sd">    release_date : str, optional</span>
<span class="sd">        Release date, by default None, which uses today&#39;s date.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Formatted release notes in .rst format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">release_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">release_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Version </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">release_date</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">header</span> <span class="o">=</span> <span class="n">header</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">detailed</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">entries</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">detailed</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">category</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">category</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">default_title</span>
            <span class="k">if</span> <span class="n">description</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">description</span> <span class="o">=</span> <span class="n">default_description</span>

            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; * *</span><span class="si">{</span><span class="n">category</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">*: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="n">detailed</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="n">detailed</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">header</span> <span class="o">+</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">detailed</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>



<div class="viewcode-block" id="get_yaml_files_from_input">
<a class="viewcode-back" href="../api.html#brass.get_yaml_files_from_input">[docs]</a>
<span class="k">def</span> <span class="nf">get_yaml_files_from_input</span><span class="p">(</span><span class="n">input_files_or_folders</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a list of YAML files from the given input files or folders.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    input_files_or_folders : list</span>
<span class="sd">        List of paths to input files or folders.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        List of paths to YAML files.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If a file is not a YAML file or if no YAML files are found in a directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">yaml_files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">input_files_or_folders</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yaml&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yml&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2"> is not a YAML file.&quot;</span><span class="p">)</span>
            <span class="n">yaml_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">dir_yaml_files</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yaml&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yml&quot;</span><span class="p">):</span>
                        <span class="n">dir_yaml_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dir_yaml_files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No YAML files found in directory </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">yaml_files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">dir_yaml_files</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml_files</span></div>



<div class="viewcode-block" id="write_output_file">
<a class="viewcode-back" href="../api.html#brass.write_output_file">[docs]</a>
<span class="k">def</span> <span class="nf">write_output_file</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Write the formatted release notes to the output file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    output_file : str</span>
<span class="sd">        Path to the output .rst file.</span>
<span class="sd">    content : str</span>
<span class="sd">        Formatted release notes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_current_git_branch">
<a class="viewcode-back" href="../api.html#brass.get_current_git_branch">[docs]</a>
<span class="k">def</span> <span class="nf">get_current_git_branch</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the current git branch name.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The name of the current git branch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">repo</span> <span class="o">=</span> <span class="n">pygit2</span><span class="o">.</span><span class="n">Repository</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">repo</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">shorthand</span></div>



<div class="viewcode-block" id="add_header_footer">
<a class="viewcode-back" href="../api.html#brass.add_header_footer">[docs]</a>
<span class="k">def</span> <span class="nf">add_header_footer</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">rich_open</span><span class="p">,</span> <span class="n">header_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">footer_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a header and/or footer to the given content.</span>

<span class="sd">    Args:</span>
<span class="sd">        content (str): The content to which the header and/or footer will be added.</span>
<span class="sd">        rich_open (function): A function used to open files.</span>
<span class="sd">        header_file (str, optional): The file containing the header content. Defaults to None.</span>
<span class="sd">        footer_file (str, optional): The file containing the footer content. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The content with the header and/or footer added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">getFile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rich_open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Reading </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">header_file</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">getFile</span><span class="p">(</span><span class="n">header_file</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">content</span>
    <span class="k">if</span> <span class="n">footer_file</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">content</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">getFile</span><span class="p">(</span><span class="n">footer_file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">content</span></div>



<div class="viewcode-block" id="build_release_notes">
<a class="viewcode-back" href="../api.html#brass.build_release_notes">[docs]</a>
<span class="k">def</span> <span class="nf">build_release_notes</span><span class="p">(</span>
    <span class="n">input_files_or_folders</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">,</span>
    <span class="n">console</span><span class="p">,</span>
    <span class="n">rich_open</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">release_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">header_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">footer_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build release notes from YAML data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : dict</span>
<span class="sd">        Parsed content of YAML files.</span>
<span class="sd">    version : str, optional</span>
<span class="sd">        Version number of the release, by default &#39;1.1&#39;.</span>
<span class="sd">    release_date : str, optional</span>
<span class="sd">        Release date, by default None, which uses today&#39;s date.</span>
<span class="sd">    header_file : str, optional</span>
<span class="sd">        A header file to prepend to the release notes.</span>
<span class="sd">    footer_file : str, optional</span>
<span class="sd">        A footer file to suffix to the release notes.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Formatted release notes in .rst format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">yaml_files</span> <span class="o">=</span> <span class="n">get_yaml_files_from_input</span><span class="p">(</span><span class="n">input_files_or_folders</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[red]Invalid file or directory: [bold]</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">[/]&quot;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[red]</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">read_yaml_files</span><span class="p">(</span><span class="n">yaml_files</span><span class="p">,</span> <span class="n">rich_open</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">format_release_notes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">add_header_footer</span><span class="p">(</span>
        <span class="n">content</span><span class="p">,</span> <span class="n">rich_open</span><span class="p">,</span> <span class="n">header_file</span><span class="o">=</span><span class="n">header_file</span><span class="p">,</span> <span class="n">footer_file</span><span class="o">=</span><span class="n">footer_file</span>
    <span class="p">)</span>
    <span class="n">write_output_file</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[green]Wrote release notes to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">content</span></div>



<div class="viewcode-block" id="setup_console">
<a class="viewcode-back" href="../api.html#brass.setup_console">[docs]</a>
<span class="k">def</span> <span class="nf">setup_console</span><span class="p">(</span><span class="n">no_format</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set up and return the console for printing messages.</span>

<span class="sd">    Args:</span>
<span class="sd">        no_format (bool, optional): Whether to disable formatting. Defaults to False.</span>
<span class="sd">        quiet (bool, optional): Whether to suppress console output. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Console: The configured rich console object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">(</span><span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span> <span class="n">no_color</span><span class="o">=</span><span class="n">no_format</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">console</span></div>



<div class="viewcode-block" id="run_from_CLI">
<a class="viewcode-back" href="../api.html#brass.run_from_CLI">[docs]</a>
<span class="k">def</span> <span class="nf">run_from_CLI</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function to generate release notes from YAML files and write to an output file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span><span class="p">,</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">parse_arguments</span><span class="p">()</span>

    <span class="n">console</span> <span class="o">=</span> <span class="n">setup_console</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">no_rich</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">quiet</span><span class="p">)</span>
    <span class="n">rich_open</span> <span class="o">=</span> <span class="n">get_rich_opener</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">no_rich</span><span class="p">)</span>

    <span class="n">exit_on_invalid_arguments</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">console</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;write_yaml_template&quot;</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">create_blank_template_yaml_file</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">write_yaml_template</span><span class="p">,</span> <span class="n">console</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">input_files_or_folders</span><span class="p">:</span>
        <span class="n">build_release_notes</span><span class="p">(</span>
            <span class="n">args</span><span class="o">.</span><span class="n">input_files_or_folders</span><span class="p">,</span>
            <span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">,</span>
            <span class="n">console</span><span class="p">,</span>
            <span class="n">rich_open</span><span class="p">,</span>
            <span class="n">version</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
            <span class="n">release_date</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">release_date</span><span class="p">,</span>
            <span class="n">header_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">prefix_file</span><span class="p">,</span>
            <span class="n">footer_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">suffix_file</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="s2">&quot;write_yaml_template&quot;</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">input_files_or_folders</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span></div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">run_from_CLI</span><span class="p">()</span>
</pre></div>

          </div>

        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">brass</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.

      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>

    </div>




  </body>
</html>